<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Etude: ${etude_name}</title>
    <style>
        body { font-family: sans-serif; margin: 20px; line-height: 1.6; }
        h1, h2 { border-bottom: 1px solid #eee; padding-bottom: 5px; }
        table { border-collapse: collapse; margin-top: 20px; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 10px; text-align: left; vertical-align: top; }
        th { background-color: #f0f0f0; }
        pre { background-color: #f5f5f5; padding: 10px; border-radius: 4px; white-space: pre-wrap; word-wrap: break-word; }
        ul { padding-left: 20px; }
        .status-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 5px 10px;
            background-color: #f0f0f0;
            border-top: 1px solid #ccc;
            font-size: 0.8em;
            text-align: center;
        }
        .status-success { background-color: #e6ffed; color: #006622; }
        .status-error { background-color: #ffe6e6; color: #b30000; }
        .status-loading { background-color: #e6f7ff; color: #005c99; }
        .status-warning { background-color: #fff5e6; color: #996a00; }
        .placeholder { color: #888; font-style: italic; }
    </style>
</head>
<body>
    <!-- Static App Shell part -->
    <h1>Etude: ${etude_name}</h1>
    <p><em>${etude_description}</em></p>

    <h2>Static Build Information:</h2>
    <ul>
        <li>Build Timestamp: <strong>${build_timestamp}</strong></li>
        <li>Git Commit: <strong>${git_hash}</strong></li>
    </ul>

    <h2>Static Metrics (at build time):</h2>
    <ul>
        <li>Total Etudes Registered: <strong>${metrics_self_total_etudes}</strong></li>
        <li>Registered Etude Names: <strong>${metrics_self_etude_names}</strong></li>
    </ul>

    <h2>Daily Run Status Overview:</h2>
    <div id="daily-status-container">
        <p class="placeholder">Loading daily run status for all etudes...</p>
        <!-- JS will populate this with a table of statuses and action logs -->
    </div>

    <!-- Static content generated by Python can still exist if needed -->
    <h2>Registered Etude Details (at build time):</h2>
    ${etudes_table_html}

    <h2>JavaScript Log</h2>
    <div id="js-logging-panel" style="height: 200px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; background-color: #f5f5f5; margin-top: 20px;">
        <p class="placeholder">JavaScript logging will appear here...</p>
    </div>

    <!-- Status Footer -->
    <div id="etude_status_footer" class="status-footer">Initializing...</div>

    <!-- Import the Mustache module and attach it to the window object to make it globally accessible -->
    <script type="module">
        import Mustache from '/assets/js/vendor/mustache.min.js';
        window.Mustache = Mustache;
    </script>

    <!-- Load our application modules -->
    <script type="module" src="/assets/js/core/data_fetcher.js" async defer></script>
    <script type="module" src="/assets/js/core/ui_updater.js" async defer></script>
    <script type="module" src="/assets/js/zero/logger.js" async defer></script>
    <script type="module" src="/assets/js/${etude_name}/ui.js" async defer></script>
</body>
</html>
